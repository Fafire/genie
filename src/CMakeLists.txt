include_directories(${PROJECT_SOURCE_DIR}/src)
cuda_include_directories(${PROJECT_SOURCE_DIR}/src)
link_directories(${PROJECT_SOURCE_DIR}/src)

set(LIB_SRC_LIST
  GaLG.h

  GaLG/lib/libcsv/csv.h
  GaLG/lib/libcsv/libcsv.c

  GaLG/lib/bucket_topk/assign_bucket.inc
  GaLG/lib/bucket_topk/bucket_topk.h
  GaLG/lib/bucket_topk/bucket_topk.inc
  GaLG/lib/bucket_topk/count_sum.inc
  GaLG/lib/bucket_topk/result_thread_partition.inc
  GaLG/lib/bucket_topk/save_result.inc
  GaLG/lib/bucket_topk/update_min_max.inc
  GaLG/lib/bucket_topk/utils.inc

  GaLG/raw_data.h
  GaLG/raw_data.cc
  GaLG/inv_list.h
  GaLG/inv_list.cc
  GaLG/inv_table.h
  GaLG/inv_table.cc
  GaLG/query.h
  GaLG/query.cc
  GaLG/match.h
  GaLG/match.cu
  GaLG/topk.h
  GaLG/topk.cu
  GaLG/interface.h
  GaLG/interface.cu
  GaLG/knn.h
  GaLG/knn.cu

  GaLG/parser/parser.h
  GaLG/parser/csv.cc)

#cuda_add_library(
#  ${PROJECT_NAME}
#  SHARED
#  ${LIB_SRC_LIST})

cuda_add_library(
  ${PROJECT_NAME}
  STATIC
  ${LIB_SRC_LIST})


set_target_properties(
  ${PROJECT_NAME}
  PROPERTIES
  VERSION ${PROJECT_API_VERSION}.${PROJECT_MINOR_VERSION}
  SOVERSION ${PROJECT_API_VERSION})


install(TARGETS ${PROJECT_NAME} 
	LIBRARY DESTINATION lib
	ARCHIVE DESTINATION lib)
install(FILES GaLG.h DESTINATION include)

function(install_header TARGET)
  install(FILES GaLG/${TARGET} DESTINATION include/GaLG)
endfunction()

install(FILES GaLG/parser/parser.h DESTINATION include/GaLG/parser)
install_header(raw_data.h)
install_header(inv_list.h)
install_header(inv_table.h)
install_header(query.h)
